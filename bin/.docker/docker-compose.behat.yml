version: '2'
services:
    selenium:
        image: selenium/standalone-firefox
        ports:
            - "9999:9999"
            - "4444:4444"
        environment:
            - SCREEN_WIDTH=1920
            - SCREEN_HEIGHT=1080
            - SCREEN_DEPTH=24

    behatphpcli:
        # @todo: Should be a clean eZ PHP image
        image: plopix/docker-php-ez-engine
        depends_on:
             - db
             - web
             - selenium
        volumes_from:
            - appvol
        environment:
             - "SYMFONY_ENV=behat"
             - "SYMFONY_DEBUG=1"
             - DATABASE_USER
             - DATABASE_PASSWORD
             - DATABASE_NAME
             - DATABASE_HOST=db
        command: /bin/sh -c "cp -f behat.yml.dist behat.yml; sed -i 's@localhost:4444@selenium:4444@' behat.yml; sed -i 's@localhost@web@' behat.yml"
